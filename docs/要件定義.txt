1. 背景・目的

Markdown記法・リッチテキストスタイル（フォント、色など）・フローチャートおよびそのアウトラインを同一ドキュメント内で編集できるクロスプラットフォームWebアプリを開発する。ブラウザ上での完結を前提に、オフライン利用をサポートするPWA（インストール可能、IndexedDBによるローカル保存）を目標とする。ドキュメント作成や簡易的なプレゼン資料の作成において、視覚的な強調と構造の整理を同時に行える環境を提供する。

2. 対象ユーザー

・Markdown形式でブログや技術文書を書くユーザー
・ノンコーディングユーザーでも使える視覚的な操作性を重視
・WindowsまたはmacOSユーザー（Webアプリ想定）


3. UI レイアウト（主要画面）

3.1 ヘッダー

左 : アウトライン表示非表示切り替え
中央 : ファイル名
右 : 開く / 名前を付けて保存 / 設定 

3.2 メイン領域（上下分割）

上 : フローチャートキャンバス（最小化可能とする）
下 : テキストエディタ

3.3 左側パネル

全体 : H1〜H4 見出し一覧（リアルタイム更新、階層表示、クリックでジャンプ、同期スクロール）


4. 機能要件

4.1 テキスト編集機能

機能　／　内容
入力　／　通常のテキスト編集（挿入・削除・コピー・貼り付け）
選択　／　範囲選択、行選択、単語選択
Undo　／　 Redo／操作の取り消し・やり直し（Ctrl+Z / Ctrl+Y）

4.2 画像挿入機能

・画像貼り付け対応　テキスト中に画像のドラッグ＆ドロップ／クリップボード対応（ローカル参照）
・貼り付けた画像はサイズを調整可能とする（画面幅を100%ととして、ウインドウサイズに応じて越えないように可変させる）
・画像削除機能　バックスペース、デリートで削除

4.3 スタイル編集機能（GUI操作）

4.1の選択した範囲に対してテキストの上側にフローティングメニューを表示する。固定のツールバーは作成しない。
メニューよりGUI操作を行い以下のスタイル編集を適用する。
また、メニューのアイコンで現在適用されているスタイルが伝わるようにする。

項目　／　内容
太字・斜体・下線　／　ボタンやショートカットで切り替え
箇条書き・番号付きリスト　／　ボタンやショートカットで切り替え
引用　／　引用ブロック挿入
コードブロック　／　インラインコード（``）とブロックコード（```）対応
見出し　／　H1～H4＋テキストをプルダウンメニューで選択、解除
文字色　／　カラーピッカーで指定（RGB/HEX）
ハイライト　／　背景色の変更
ルビ　／　選択範囲のテキスト上部にルビを設定する

4.4 検索・置換機能

・検索文字列の強調表示（正規表現対応）
・一括または個別置換が可能

4.5 アウトライン機能

・編集領域の左側にH1～H4の見出しの一覧をリアルタイム表示
・階層をインデントで視覚化
・テキストエディタと同期スクロール
・見出しをクリックでエディタのテキストをスクロールし、ジャンプ可能とする

4.6 フローチャート対応機能

・H1～H4の見出しを図形として上部キャンバスに自動生成
・Markdownの見出しと連動したリアルタイム更新
・図形の位置はドラッグで自由に移動可能
・図形同士の接続線を描画編集可能とする
・図形は背景色・枠線色、文字色のスタイル編集可能とする（右クリックメニュー）
・図形は親子のグループを作成可能とする（親子関係については3.5.1に詳細）
・接続線は色やスタイル（片側矢印、両端矢印、矢印なし）、ラベルを編集可能とする

4.6.1 フローチャートの親子関係
4.6.1.①．グループの定義 
パソコンのようなフォルダ階層で親と子を定義します。下は例です。
図形1
├図形2
└図形3
図形4 

4.6.1.②．グループの表示 
親の図形をキャンバスに見立てて内側に子の図形を表示します。下は例です。 
┌─────────────────┐
│　　　図形１　　　│
│　┌─────┐　┌─────┐│
│　│図形２│　│図形３││
│　└─────┘　└─────┘│
└─────────────────┘
なお、親または子の図形がアクティブ（選択されている）状態の時（上の例では図形1,2,3の選択されている時）には上のように表示をします。
この時、図形１のスタイルは変更しないでください。

4.6.1.③．グループの折りたたみ
親とした図形の右上に折りたたみボタンを配置します。
折りたたみボタンを押した場合、この図形を非表示にして親の図形のみ表示した状態にします。
下は上のグループを折りたたんだ時の表示です。
┌─────┐
│図形１│
└─────┘
②の展開と③の折りたたみを行う際には、展開と折りたたみにより増減する幅と高さの分、キャンバスの他の図形や線を移動してください。重なりを回避するためです。 

4.6.1.④．グループ化の手順 
図形を移動させて、グループの親となる図形に重ねるようにドラッグ＆ドロップすることでグループ化します。
例えば図形1をグループの親、図形2をグループの子とする場合、図形2を図形1に重ねるように移動してドラッグ＆ドロップします。

4.6.1.⑤．グループ解除の手順 
図形を移動させて、グループの親となる図形の外側にドラッグ＆ドロップすることでこの図形をグループ解除します。
例えば図形1をグループの親、図形2をグループの子とする場合、図形2を図形1の外側へ移動させるようにドラッグ＆ドロップします。

4.6.1.⑥．制約
＜図形1：親、図形2：子＞としたときに、＜図形1：子、図形2：親＞となるような循環関係の設定を作成できないようにしてください。循環関係になるようなグループ化の手順④をしたとしても、グループとせずに処理をパスしてください。


4.7 ファイル操作

項目　／　内容
開くor名前を付けて保存　.zipを想定（テキストのスタイル情報、画像、フローチャート情報含む）
　zipファイルにはhtmlファイルとテキスト内に挿入された画像、configを格納する

4.7.1 保存したファイルについて

・このウェブアプリを使わなくても読み取り専用のファイルとして、htmlをダブルクリックして開くとビューワーとして機能するようにします。（テキストのスタイル情報、画像、フローチャート情報含む）編集機能のみを省くイメージです

4.8 環境設定

・ダーク／ライトテーマの切り替え
・テキストエディタのフォントファミリについて任意のフォントを見出しごとに選択可能（例：游ゴシック、Meiryo、Arialなど）
・テキストエディタのフォントサイズについて見出しごとに変更可能
・メイン領域の背景について、単色もしくはアップロードした画像に変更可能とする。初期配色はダーク／ライトテーマに基づく


5. 非機能要件

項目　／　内容
UIフレームワーク　適切に技術選定を行ってください
操作性　マウスとショートカット操作に対応
レスポンス	操作に対して0.5秒以内の応答
クロスプラットフォーム　Windows / macOS
動作要件　ブラウザ（Chromium系、Firefox、Safari）、PWA対応でインストール可能。動作検証は最新の主要ブラウザで実施。　なお、完全なオフライン状態でもサーバーを介さずに動作可能とする。
アクセシビリティ　ダーク／ライトテーマ、フォントサイズ変更対応、色覚対応テーマの選択
多言語対応	初期版は日本語、将来的に英語UI切替に対応
バージョン管理	1.0.0 からのセマンティックバージョニング採用、今後のアップデートに備えた構造
セキュリティ要件　ローカルストレージのみで完結。ファイル入出力時は HTML サニタイズ、XSS対策を徹底。スクリプトタグの無効化等による安全性確保
エラーハンドリング	保存失敗や解析エラー時に明確なメッセージ表示と該当箇所のハイライト表示

